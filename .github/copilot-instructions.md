# PingPong App – AI Working Notes

- Architecture: Angular 17 standalone app; single-root component [src/app/app.component.ts](src/app/app.component.ts#L22-L197) bootstrapped via [src/main.ts](src/main.ts#L1-L4) with empty route table [src/app/app.routes.ts](src/app/app.routes.ts#L1-L2). HTTP + service worker providers live in [src/app/app.config.ts](src/app/app.config.ts#L1-L15).
- Core flow: form submits a match → stored in localStorage (`pingpong_matches`) → optionally synced to Google Sheets → rendered in recent list. See submit + save logic in [src/app/app.component.ts](src/app/app.component.ts#L56-L150).
- Local state: `players` array defines column ordering and the dropdown options; update it to add/remove players [src/app/app.component.ts](src/app/app.component.ts#L32-L54). `match` resets but preserves selected players after submit [src/app/app.component.ts](src/app/app.component.ts#L84-L90).
- Google Sheets integration: service pulls config from environment files [src/environments/environment.ts](src/environments/environment.ts#L1-L8) / [src/environments/environment.prod.ts](src/environments/environment.prod.ts#L1-L9). Writes prefer the Apps Script web app via `fetch` no-cors; direct Sheets API append is fallback for OAuth setups [src/app/google-sheets.service.ts](src/app/google-sheets.service.ts#L49-L141). Deletes also go through the web app [src/app/google-sheets.service.ts](src/app/google-sheets.service.ts#L143-L176). Reads require `spreadsheetId`, `apiKey`, `sheetName` [src/app/google-sheets.service.ts](src/app/google-sheets.service.ts#L37-L42).
- Data shape: Sheet rows expected as `Date, Dad, Luc, Alex, Mom`; parser skips header rows containing "date" and maps scores by column index [src/app/app.component.ts](src/app/app.component.ts#L152-L197). Recent matches are reversed for newest-first display.
- Google Apps Script: Deployment script that handles POST/DELETE and CORS is in [google-apps-script/Code.gs](google-apps-script/Code.gs#L1-L103); keep it in sync with player columns and sheet name (`Sheet1`).
- UI: Tailwind utility classes live inline in the template [src/app/app.component.html](src/app/app.component.html). Component stylesheet is empty; prefer template utilities or add scoped CSS there. PWA icons are SVG placeholders in [src/assets/icons](src/assets/icons).
- PWA/service worker: Service worker only enables in production builds (`ng build` default config) via `ngsw-config.json` [src/app/app.config.ts](src/app/app.config.ts#L7-L15) and [ngsw-config.json](ngsw-config.json#L1-L27). Manifest and colors in [src/manifest.webmanifest](src/manifest.webmanifest#L1-L21).
- Commands: `npm start` (dev serve), `npm run build` (prod PWA bundle to dist/pingpong-app/browser), `npm test` (Karma), `npm run deploy` (build with base-href and push via angular-cli-ghpages).
- Testing gotcha: unit spec still expects old title/text `pingpong-app` and `Hello, pingpong-app` [src/app/app.component.spec.ts](src/app/app.component.spec.ts#L17-L28) while current UI title is "PingPong Stats Tracker" [src/app/app.component.ts](src/app/app.component.ts#L30-L33) and template lacks that string; adjust tests or UI intentionally.
- Storage behavior: `loadMatches` hydrates from localStorage, then replaces with remote sheet data if read config is present [src/app/app.component.ts](src/app/app.component.ts#L111-L135). Deleting removes local and optionally posts delete to the sheet [src/app/app.component.ts](src/app/app.component.ts#L136-L150).
- Safety: environment files currently contain real-looking keys/URLs; keep secrets rotated and avoid leaking if reusing this repo. Ensure any new players/columns stay consistent across UI, parser, Apps Script, and sheet layout.
- Styling conventions: Tailwind base imported in [src/styles.css](src/styles.css#L1-L3); content scanning configured in [tailwind.config.js](tailwind.config.js#L1-L10). Prefer gradient background header/footer pattern already in template.
- Assets & offline: Assets cached lazily; update `ngsw-config.json` if adding new asset types. Icons referenced in manifest expect matching files; regenerate if changing sizes/types.
